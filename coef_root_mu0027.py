"""Вычисление коэффициентов уравнения 4 степени (с лекарствами)
и значения x по известным значениям y и разным коэффициентам b"""

# from main_functions import *

sigma = 0.1181
row = 1.131
eta = 20.19
delta = 0.3743
alfa = 1.636
beta = 0.002
mu = 0.0027

"""
Построй фазовые портреты при b=0.2; 0.9; 1.0; 1.2; 1.4; 12.0. И сепаратрисы. мю=0.0027
"""


def coefficients(b):
    A = alfa*beta*mu  # y**4
    B = -alfa*beta*row - alfa*mu + alfa*beta*mu + alfa*beta*mu*eta + alfa*beta*delta  # y**3
    C = sigma + alfa*row - alfa*beta*row - alfa*mu - alfa*mu*eta + alfa*beta*mu*eta + b*mu - \
        alfa*delta + alfa*beta*delta + alfa*beta*delta*eta  # y**2
    D = sigma*eta + sigma - b*row + alfa*row - alfa*mu*eta + b*mu*eta - alfa*delta - \
        alfa*delta*eta + alfa*beta*delta*eta + b*delta  # y
    E = sigma*eta - alfa*delta*eta + b*delta*eta

    return A, B, C, D, E


b_list = [0.01, 0.05, 0.1, 0.2, 0.9, 1.0, 1.2, 1.4, 12]

eq_coef_lists = [[8.8344e-06, -0.006705921463999998, 1.28491706296, -8.694421463176, -9.903433242],
                 [8.8344e-06, -0.006705921463999998, 1.28502506296, -8.722508943175999, -9.601148562],
                 [8.8344e-06, -0.006705921463999998, 1.2851600629600002, -8.757618293176, -9.223292712],
                 [8.8344e-06, -0.006705921463999998, 1.2854300629600002, -8.827836993176001, -8.467581012],
                 [8.8344e-06, -0.006705921463999998, 1.2873200629600001, -9.319367893176, -3.1775991119999993],
                 [8.8344e-06, -0.006705921463999998, 1.2875900629600001, -9.389586593176, -2.4218874119999994],
                 [8.8344e-06, -0.006705921463999998, 1.28813006296, -9.530023993175998, -0.9104640120000003],
                 [8.8344e-06, -0.006705921463999998, 1.28867006296, -9.670461393176, 0.6009593880000015],
                 [8.8344e-06, -0.006705921463999998, 1.3172900629600002, -17.113643593176, 80.70639958800001]]

y_lists = [[340.816698328777, 8.058286127809197, 411.18694698259463, -0.992672179921783],
           [340.8630543596746, 8.05052630748682, 411.1190070057004, -0.9633284136026816],
           [340.9211339128284, 8.040754470768576, 411.03394574557194, -0.9265748699098992],
           [341.0377449265783, 8.020965777117596, 410.8633654020245, -0.8528168464613373],
           [341.8715103388879, 7.872395529938871, 409.6515936701903, -0.3262402797579682],
           [341.99321619599243, 7.849580960334805, 409.4758553142504, -0.24939321131853376],
           [342.2386621156887, 7.802609455398141, 409.12232068065646, -0.09433299248425442],
           [342.4868821294684, 7.753729838760535, 408.7659803185803, 0.06266697244979014],
           [377.5720937657258, 367.90472625937474, 6.796219617079231+4.424536730688678j, 6.796219617079231-4.424536730688678j]]

x_lists = [[0.5208185076221241, 1.6085293261949871, 0.2905720486367612, 0.2745856963422685],
           [0.5205498287394934, 1.604134137326, 0.2906972848987737, 0.2756985875765092],
           [0.5202135847331949, 1.598629627612696, 0.29085423107043973, 0.2771002197610019],
           [0.5195397678125769, 1.5875848247925926, 0.2911694704689477, 0.2799392493734292],
           [0.5147715281675813, 1.5088033029185244, 0.2934283466282672, 0.3012796796135661],
           [0.5140826870491458, 1.497316470379507, 0.29375880452697795, 0.3045605446407478],
           [0.512698987904191, 1.474146649287272, 0.2944258104035499, 0.311318357538589],
           [0.5113070746085246, 1.4506979696732616, 0.2951011281342861, 0.3183549312548442],
           [0.3688860516881936, 0.3996870117410943, (0.4495334313581578+0.6462502583209729j), (0.4495334313581578-0.6462502583209729j)]]

for i in range(len(b_list)):
    x_lists.append([])
    for j in y_lists[i]:
        if j == -1:
            x_lists[i].append(None)
            continue
        x_lists[i].append((alfa + alfa*j - alfa*beta*j - alfa*beta*(j**2) - b_list[i])/(1+j))

for i in x_lists:
    print(i)

print(x_lists)

# print(coefficients(0.1))
